function LokasyonDetay(e) { $("#L_Adi").text(e.Adi.toUpperCase()), $("#L_ToplamS").text(parseInt(e.ToplamSandik).toLocaleString()), $("#L_AcilanS").text(parseInt(e.AcilanSandik).toLocaleString()), $("#L_KullanilanOy").text(parseInt(e.KullanilanOy).toLocaleString()), $("#L_GecerliOy").text(parseInt(e.GecerliOy).toLocaleString()) } function moveScroll() { if (void 0 != $(".backgrid")) { var e = $(window).scrollTop(), i = $(".backgrid").offset().top, t = $("#bottom_anchor").offset().top; e > i && t > e ? (clone_table = $("#clone"), 0 == clone_table.length && (clone_table = $(".backgrid").clone(), clone_table.attr("id", "clone"), clone_table.css({ position: "fixed", top: 0, "background-color": "#F8F9F9" }), $("th", clone_table).css({ "background-color": "#F8F9F9" }), clone_table.width($(".backgrid").width()), $("#TurkiyeGrid").append(clone_table), $("#clone").css({ visibility: "hidden" }), $("#clone thead").css({ visibility: "visible" }))) : $("#clone").remove() } } function CanvasCizme() { !function (e, i, t, a) { function n(e, i) { arguments.length && this._init(e, i) } n.prototype = { defaults: { percent: !0, value: 0, maxValue: 100, radius: 32, thickness: 6, backFillColor: "rgb(199, 199, 199)", fillColor: "#e15656", centerFillColor: "#222", decimals: 0, retinaReady: !0 }, _init: function (i, t) { this.element = e(i), this.options = e.extend({}, this.defaults, t, this.element.data()), this.canvas = this._build(), this._draw(this._prepareCanvas(this.canvas)) }, _build: function () { var a = e("<span></span>"), n = t.createElement("canvas"); if (this.element.append(a.clone().addClass("digit-container")).append(a.clone().addClass("canvas-container").append(e(n))).addClass("circular-stat"), !n.getContext) { if ("undefined" == typeof i.G_vmlCanvasManager) return console.log("Your browser does not support HTML5 Canvas, or excanvas.js is missing on IE"), this.element.hide(), !1; n = i.G_vmlCanvasManager.initElement(n) } return n }, _getPixelRatio: function (e) { return (i.devicePixelRatio || 1) / (e.webkitBackingStorePixelRatio || e.mozBackingStorePixelRatio || e.msBackingStorePixelRatio || e.oBackingStorePixelRatio || e.backingStorePixelRatio || 1) }, _prepareCanvas: function (e) { var i = 2 * this.options.radius, t = e.getContext("2d"), t = this._getPixelRatio(t); return e.width = e.height = i * t, t > 1 && (e.style.width = i + "px", e.style.height = i + "px"), e }, _draw: function (i) { var t = i.getContext("2d"), a = this._getPixelRatio(t), n = 2 * (this.options.value / this.options.maxValue) * Math.PI, l = i.width / 2, o = i.height / 2, r = this.options.radius, s = 100 != parseInt(this._getVal()) ? this._getVal().toFixed(2) : this._getVal(); t.save(), t.clearRect(0, 0, i.width, i.height), t.translate(l, o), t.scale(a, a), t.rotate(-Math.PI / 2), t.fillStyle = this.options.backFillColor, t.beginPath(), t.arc(0, 0, r, 0, 2 * Math.PI, !1), t.closePath(), t.fill(), t.fillStyle = this.options.fillColor, t.beginPath(), t.arc(0, 0, r, 0, n, !1), t.lineTo(0, 0), t.closePath(), t.fill(), t.fillStyle = this.options.centerFillColor, t.beginPath(), t.arc(0, 0, r - this.options.thickness, 0, 2 * Math.PI, !1), t.closePath(), t.fill(), t.restore(), e(".digit-container", this.element).css({ lineHeight: 2 * this.options.radius + "px" })[0].innerHTML = this.options.percent ? "<span>%" + s + "</span>" : "<span>" + s + "</span>/" + this.options.maxValue.toFixed(this.options.decimals) }, _getVal: function () { return this.options.percent ? 100 * (this.options.value / this.options.maxValue) : this.options.value }, option: function (i, t) { if (0 === arguments.length) return e.extend({}, this.options); if ("string" == typeof i) { if (t === a) return this.options[i]; switch (i) { case "value": t = Math.max(0, Math.min(t, this.options.maxValue)) } this.options[i] = t, this._draw("radius" === i ? this._prepareCanvas(this.canvas) : this.canvas) } return this } }, e.fn.circularStat = function (i) { var t = "string" == typeof i, l = Array.prototype.slice.call(arguments, 1), o = this; return t && "_" === i.charAt(0) ? o : (this.each(t ? function () { var t = e.data(this, "circular"), n = t && e.isFunction(t[i]) ? t[i].apply(t, l) : t; return n !== t && n !== a ? (o = n, !1) : void 0 } : function () { e.data(this, "circular") || e.data(this, "circular", new n(this, i)) }), o) }, e(function () { e("[data-provide=circular]").each(function () { var i = e(this); i.circularStat(i.data()) }) }) }(jQuery, window, document) } function HeaderVeri() { $.ajax({ dataType: "json", url: "Handlers/GenelUstVeri.ashx", async: !0, cache: !0, success: function (e) { var i, t = e.TurkiyeGeneli, a = t.Sandik.KullanilanOy, n = (100 * t.Sandik.AcilanSandik / t.Sandik.ToplamSandik).toFixed(2); n = n >= 100 ? 100 : n, $("#CircularOrani1").html(""), $("#CircularOrani1").prepend("<span class='AcilanSandikLokasyon' data-provide='circular' data-fill-color='rgb(41, 89, 213)' data-value='" + n + "' data-radius='45' data-percent='true' data-thickness='17'></span>"), CanvasCizme(), $("#ililcetoplamsandiksayi").text(parseInt(t.Sandik.ToplamSandik).toLocaleString()), $("#ililceacilansandiksayi").text(parseInt(t.Sandik.AcilanSandik).toLocaleString()), $("#ililcetoplamsecmensayi").text(parseInt(t.Sandik.ToplamSecmen).toLocaleString()), $("#ililcekullanilanoy").text(parseInt(t.Sandik.KullanilanOy).toLocaleString()), $("#ililceacilansandikorani").text("% " + n), $("#ililcegecerlioy").text(parseInt(t.Sandik.GecerliOy).toLocaleString()); var l = t.Sonuclar.Parti; l.sort(function (e, i) { return i.Oy - e.Oy }), $("#Birinci_Sonuc > .MilletSayisi > span").text(l[0].MilletVekiliSayisi), $("#Birinci_Footer_Logo").attr("src", "../images/logo" + l[0].No + ".png"), i = (100 * l[0].Oy / a).toFixed(2), i = i >= 100 ? 100 : i, i = "0" == a ? "0.00" : i, $("#Birinci_Sonuc > .footerSonuc").text("% " + i), $("#Ikinci_Sonuc > .MilletSayisi > span").text(l[1].MilletVekiliSayisi), $("#Ikinci_Footer_Logo").attr("src", "../images/logo" + l[1].No + ".png"), i = (100 * l[1].Oy / a).toFixed(2), i = i >= 100 ? 100 : i, i = "0" == a ? "0.00" : i, $("#Ikinci_Sonuc > .footerSonuc").text("% " + i), $("#Ucuncu_Sonuc > .MilletSayisi > span").text(l[2].MilletVekiliSayisi), $("#Ucuncu_Footer_Logo").attr("src", "../images/logo" + l[2].No + ".png"), i = (100 * l[2].Oy / a).toFixed(2), i = i >= 100 ? 100 : i, i = "0" == a ? "0.00" : i, $("#Ucuncu_Sonuc > .footerSonuc").text("% " + i), $("#Dorduncu_Sonuc > .MilletSayisi > span").text(l[3].MilletVekiliSayisi), $("#Dorduncu_Footer_Logo").attr("src", "../images/logo" + l[3].No + ".png"), i = (100 * l[3].Oy / a).toFixed(2), i = i >= 100 ? 100 : i, i = "0" == a ? "0.00" : i, $("#Dorduncu_Sonuc > .footerSonuc").text("% " + i), $("#Besinci_Sonuc > .MilletSayisi > span").text(l[4].MilletVekiliSayisi), $("#Besinci_Footer_Logo").attr("src", "../images/logo" + l[4].No + ".png"), i = (100 * l[4].Oy / a).toFixed(2), i = i >= 100 ? 100 : i, i = "0" == a ? "0.00" : i, $("#Besinci_Sonuc > .footerSonuc").text("% " + i) } }) } function FiltrelemeYap(e) { return "-" == e ? ($("[type='search']").val(""), void $("[type='search']").trigger("keydown")) : ($("[type='search']").val(""), $("[type='search']").val(e), void $("[type='search']").trigger("keydown")) } function AjaxCalls() { "0" == SeciliLocation ? (GenelVeri(), DunyaHarita1()) : "1" == SeciliLocation && (GenelVeri(), DunyaHarita1()), setTimeout(function () { AjaxCalls() }, TekrarSuresi) } function DunyaHarita() { var e = [], i = "{"; $.ajax({ type: "GET", url: "Handlers/YurtDisiHarita.ashx", success: function (t) { var a = JSON.parse(t); $.each(a, function (t, a) { renk = PartiRenkler[a.Kod][1], i += '"' + a.Id + '" : "' + renk + '",'; var n = { ad: PartiRenkler[a.Kod][0], renk: PartiRenkler[a.Kod][1] }; JSON.stringify(e).indexOf(n.ad) < 0 && e.push(n) }), e.sort(function (e, i) { var t = e.ad, a = i.ad; return a > t ? -1 : t > a ? 1 : 0 }), $("#wmap div.MapLogo2").remove(), $("#wmap").prepend("<div class='MapLogo2'></div>"), $("#haritaLegends").html(""), $.each(e, function (e, i) { $("#haritaLegends").append("<div><div style='background:" + i.renk + "' ></div><div>" + i.ad + "</div></div>") }), i = i.substring(0, i.length - 1), i += "}", i = JSON.parse(i), $("#wmap").vectorMap({ map: "world_en", backgroundColor: "transparent", color: "#FFFFFF", hoverOpacity: .6, selectedColor: "#666666", enableZoom: !1, values: i, onRegionClick: function (e, i, t) { i.indexOf("*") <= -1 && ($("#Location").text(t.toUpperCase()), $("#Sehirler").val(i), SeciliLocation = "1", SeciliId = i, PieChartOyOran()) }, scaleColors: ["#C8EEFF", "#006491"], normalizeFunction: "polynomial" }) } }) } function DunyaHarita1() { var e = [], i = "{"; $.ajax({ type: "GET", url: "Handlers/YurtDisiHarita.ashx", success: function (t) { var a = JSON.parse(t); $.each(a, function (t, a) { renk = PartiRenkler[a.Kod][1], i += '"' + a.Id + '" : "' + renk + '",'; var n = { ad: PartiRenkler[a.Kod][0], renk: PartiRenkler[a.Kod][1] }; JSON.stringify(e).indexOf(n.ad) < 0 && e.push(n) }), e.sort(function (e, i) { var t = e.ad, a = i.ad; return a > t ? -1 : t > a ? 1 : 0 }), $("#haritaLegends").html(""), $.each(e, function (e, i) { $("#haritaLegends").append("<div><div style='background:" + i.renk + "' ></div><div>" + i.ad + "</div></div>") }), i = i.substring(0, i.length - 1), i += "}", i = JSON.parse(i), $("#wmap").vectorMap("set", "values", i) } }) } function GenelVeri() { $.ajax({ dataType: "json", url: "Handlers/YurtDisi.ashx", async: !0, cache: !0, success: function (e) { JsonVeri = e, GridOlustur(), PieChartOyOran(), HeaderVeri() } }) } function GridOlustur() { var e = "15", i = "11", t = "14", a = "12"; if ("0" == SeciliLocation) { $("#SehirListe").hide(), $("#TurkiyeGrid").empty(), $(".SehirlerGrid").slideDown(800); var n, l = [], o = 0, r = 0, s = 0, c = 0, d = 0, p = 0, u = 0, h = 0, g = 0, y = 0, v = 0, S = 0; $.each(JsonVeri[0].Ulkeler, function (m, f) { o = 0, r = 0, s = 0, c = 0, d = 0, p = 0, u = 0, h = 0, g = "", y = "", v = "", S = "", n = parseFloat(f.GecerliOy), $.each(f.Partiler, function (l, g) { g.No == e ? (o = parseFloat(g.oy), d = 0 != n ? o / n : 0) : g.No == i ? (r = parseFloat(g.oy), p = 0 != n ? r / n : 0) : g.No == t ? (s = parseFloat(g.oy), u = 0 != n ? s / n : 0) : g.No == a && (c = parseFloat(g.oy), h = 0 != n ? c / n : 0) }), l.push({ id: parseInt(f.Id, 10), sehir: f.Adi, toplamsecmen: parseInt(f.ToplamSecmen, 10), kullanilanoy: parseInt(f.KullanilanOy, 10), gecerlioy: parseInt(f.GecerliOy, 10), toplamsandik: parseInt(f.ToplamSandik, 10), acilansandik: parseInt(f.AcilanSandik, 10), akp_sayi: o, chp_sayi: s, mhp_sayi: r, hdp_sayi: c, akp_oran: (100 * d).toFixed(2), chp_oran: (100 * u).toFixed(2), mhp_oran: (100 * p).toFixed(2), hdp_oran: (100 * h).toFixed(2) }) }); var m = new Backbone.Collection(l), f = [{ name: "id", renderable: !1, editable: !1, label: "Id", cell: "string" }, { name: "sehir", label: "ŞEHİR", editable: !1, cell: "string" }, { name: "toplamsecmen", label: "TOPLAM SEÇMEN", editable: !1, cell: "integer" }, { name: "kullanilanoy", label: "KULLANILAN OY", editable: !1, cell: "integer" }, { name: "gecerlioy", label: "GEÇERLİ OY", editable: !1, cell: "integer" }, { name: "toplamsandik", label: "TOPLAM SANDIK", editable: !1, cell: "integer" }, { name: "acilansandik", label: "AÇILAN SANDIK", editable: !1, cell: "integer" }, { name: "akp_sayi", label: "", editable: !1, cell: "integer" }, { name: "chp_sayi", label: "", editable: !1, cell: "integer" }, { name: "mhp_sayi", label: "", editable: !1, cell: "integer" }, { name: "hdp_sayi", label: "", editable: !1, cell: "integer" }, { name: "akp_oran", label: "", editable: !1, cell: "string" }, { name: "chp_oran", label: "", editable: !1, cell: "string" }, { name: "mhp_oran", label: "", editable: !1, cell: "string" }, { name: "hdp_oran", label: "", editable: !1, cell: "string" }], k = new Backgrid.Grid({ columns: f, collection: m }); filter = new Backgrid.Extension.ClientSideFilter({ collection: m, fields: ["sehir", "id"] }), k.render().sort("sehir", "ascending"), $("#TurkiyeGrid").append(filter.render().el), $("#TurkiyeGrid").append(k.render().el), "" == !ArananKelime && ($("[type='search']").val(ArananKelime), filter.search()), RowSec(), $(window).scroll(moveScroll), $(".backgrid-filter").prepend("<i class='fa fa-search GridSearch'></i>"), $("[type='search']").attr("placeholder", "Arama"), $(".backgrid thead").prepend("<tr><th colspan='6'>SANDIK BİLGİLERİ</th><th colspan='4'>OY SAYILARI</th><th colspan='4'>OY ORANI</th></tr>"); var b = {}; $(".backgrid > tbody > tr").click(function () { $("#Sehirler").val($(this).find("td:first").text()), $("#Location").text($("#Sehirler option:selected").text()), SeciliLocation = "1", SeciliId = $(this).find("td:first").text(), PieChartOyOran(), $(".backgrid > tbody > tr > td").removeClass("secili"), $(this).find("td").addClass("secili") }), setTimeout(function () { $(".SehirlerGrid").show("blind", b, 1500) }, 500) } } function RowSec() { if (void 0 != SeciliRow) { var e = $(".backgrid > tbody > tr > td").filter(function () { return $(this).text() === SeciliRow }).parent(); e.children("td").addClass("secili") } } function PieChartOyOran() { var e; "0" == SeciliLocation ? e = JsonVeri[0].GumrukGeneli.Partiler : "1" == SeciliLocation && $.each(JsonVeri[0].Ulkeler, function (i, t) { t.Id == SeciliId && (e = t.Partiler, $(".LokasyonDetay").slideDown("slow"), LokasyonDetay(t)) }); var i = []; $.each(e, function (e, t) { 0 != parseInt(t.oy) && i.push("0" == t.No ? { country: "Diğer", value: parseInt(t.oy), color: "#F8FF01" } : { country: PartiRenkler[t.No][0], value: parseInt(t.oy), color: PartiRenkler[t.No][1] }) }); AmCharts.makeChart("piechartoyoran", { type: "pie", outlineAlpha: .8, depth3D: 11, startEffect: !0, angle: 30, startDuration: .7, startEffect: "bounce", outlineThickness: 2, legend: { markerType: "circle", position: "bottom", marginLeft: 20, valueWidth: 60, autoMargins: !1, switchable: !1 }, labelsEnabled: !0, groupPercent: 9, groupedTitle: "Diğer", groupedColor: "#F8FF01", labelText: "[[title]]", dataProvider: i, valueField: "value", titleField: "country", colorField: "color", balloonText: "[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>" }) } var SeciliLocation = "0", SeciliId = "0", JsonVeri, TekrarSuresi = 6e4, ArananKelime = "", SeciliRow; $(document).ready(function () { AjaxCalls(), DunyaHarita(), $("#Sehirler").change(function () { SeciliLocation = 0 == $(this).val() ? "0" : "1", SeciliId = $(this).val(), $("#Location").text($("option:selected", this).text().toUpperCase()), $(".LokasyonDetay").slideDown("slow"), PieChartOyOran() }) });
